/*! For license information please see main.101a3e4ff8ca092fd53a.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function n(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,r(a.key),a)}}function r(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}javascript;var a=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.cryptoService=n,this.element=this.createTapperElement(),this.setupEventListeners(),this.setupAutoTapper(),this.animationFrame=null,this.lastUpdateTime=0,this.updateInterval=1e3/60},(r=[{key:"createTapperElement",value:function(){var t=document.createElement("div");t.className="tapper-container";var e=this.userService.getTapPower(),n=this.userService.getPassiveIncome();return t.innerHTML='\n      <div class="tapper-header">\n        <div class="stats">\n          <div class="stat">\n            <span class="stat-label">Сила тапа:</span>\n            <span class="stat-value tap-power">'.concat(e,'</span>\n          </div>\n          <div class="stat">\n            <span class="stat-label">Пассивный доход:</span>\n            <span class="stat-value passive-income">').concat(n,'/сек</span>\n          </div>\n        </div>\n        <div class="total-balance">\n          <span class="balance-label">Всего:</span>\n          <span class="balance-value">').concat(this.userService.getFormattedBalance(),'</span>\n        </div>\n      </div>\n      \n      <div class="tapper-main">\n        <div class="tap-area">\n          <button class="tap-button">\n            <span class="tap-button-text">TAP!</span>\n            <span class="tap-button-subtext">Зарабатывай крипту</span>\n          </button>\n          <div class="tap-effects"></div>\n        </div>\n        \n        <div class="crypto-display">\n          <div class="crypto-ticker">\n            ').concat(this.renderCryptoTicker(),'\n          </div>\n          <div class="recent-earnings">\n            <h3>Последние заработки:</h3>\n            <div class="earnings-list"></div>\n          </div>\n        </div>\n      </div>\n      \n      <div class="bonus-section">\n        <div class="bonus-timer">\n          <div class="bonus-progress"></div>\n          <span class="bonus-time">00:00</span>\n        </div>\n        <button class="bonus-button" disabled>Бонус скоро будет доступен</button>\n      </div>\n    '),t}},{key:"renderCryptoTicker",value:function(){var t=this,n=this.userService.getCryptoBalances();return Object.entries(n).map(function(n){var r=function(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n,2),a=r[0],i=r[1];return'\n        <div class="crypto-item">\n          <span class="crypto-amount">'.concat(i.toFixed(4),'</span>\n          <span class="crypto-name">').concat(t.cryptoService.getCryptoName(a),'</span>\n          <span class="crypto-symbol">').concat(a,"</span>\n        </div>\n      ")}).join("")}},{key:"setupEventListeners",value:function(){var t=this;this.tapButton=this.element.querySelector(".tap-button"),this.tapButton.addEventListener("click",function(){return t.handleTap()}),this.bonusButton=this.element.querySelector(".bonus-button"),this.bonusButton.addEventListener("click",function(){return t.claimBonus()}),this.startGameLoop()}},{key:"setupAutoTapper",value:function(){var t=this;this.userService.hasAutoTapper()&&(this.autoTapperInterval=setInterval(function(){t.handleAutoTap()},1e3))}},{key:"startGameLoop",value:function(){var t=this,e=function(n){t.lastUpdateTime||(t.lastUpdateTime=n);var r=n-t.lastUpdateTime;r>=t.updateInterval&&(t.update(r),t.lastUpdateTime=n-r%t.updateInterval),t.animationFrame=requestAnimationFrame(e)};this.animationFrame=requestAnimationFrame(e)}},{key:"update",value:function(t){if(this.userService.hasPassiveIncome()&&(this.passiveIncomeAccumulator+=this.userService.getPassiveIncome()*(t/1e3),this.passiveIncomeAccumulator>=1)){var e=Math.floor(this.passiveIncomeAccumulator);this.userService.addPassiveIncome(e),this.passiveIncomeAccumulator-=e,this.updateUI()}this.updateBonusTimer(t)}},{key:"handleTap",value:function(){var t=this;if(!this.isTapCooldown){this.isTapCooldown=!0,setTimeout(function(){t.isTapCooldown=!1},100);var e=this.cryptoService.getRandomCrypto(),n=this.calculateEarnings();this.userService.addCrypto(e,n),this.createTapEffect(n,e),this.updateUI(),this.userService.incrementTapCount()}}},{key:"handleAutoTap",value:function(){if(this.userService.hasAutoTapper()){var t=this.cryptoService.getRandomCrypto(),e=.5*this.calculateEarnings();this.userService.addCrypto(t,e),this.createAutoTapEffect(e,t),this.updateUI()}}},{key:"calculateEarnings",value:function(){var t=this.userService.getTapPower();return this.userService.hasMultiTap()&&Math.random()<.25&&(t*=2),this.userService.hasSubscription()&&(t*=this.userService.getSubscriptionMultiplier()),this.isBonusActive&&(t*=this.bonusMultiplier),Math.floor(t)}},{key:"createTapEffect",value:function(t,e){var n=this.element.querySelector(".tap-effects"),r=document.createElement("div");r.className="tap-effect";var a=this.cryptoService.getCryptoSymbol(e);r.innerHTML='\n      <span class="earn-amount">+'.concat(t.toFixed(2),'</span>\n      <span class="crypto-symbol">').concat(a,"</span>\n    ");var i=Math.random()*Math.PI*2,o=30+50*Math.random(),s=Math.cos(i)*o,c=Math.sin(i)*o;r.style.left="calc(50% + ".concat(s,"px)"),r.style.top="calc(50% + ".concat(c,"px)"),n.appendChild(r),setTimeout(function(){r.style.transform="translate(".concat(2*s,"px, ").concat(2*c-100,"px)"),r.style.opacity="0",setTimeout(function(){r.remove()},1e3)},10),this.addToEarningsList(t,e)}},{key:"createAutoTapEffect",value:function(t,e){var n=this.element.querySelector(".tap-effects"),r=document.createElement("div");r.className="tap-effect auto-tap";var a=this.cryptoService.getCryptoSymbol(e);r.innerHTML='\n      <span class="earn-amount">+'.concat(t.toFixed(2),'</span>\n      <span class="crypto-symbol">').concat(a,"</span>\n    "),r.style.left="".concat(10+80*Math.random(),"%"),r.style.bottom="10%",n.appendChild(r),setTimeout(function(){r.style.transform="translateY(-100px)",r.style.opacity="0",setTimeout(function(){r.remove()},1e3)},10)}},{key:"addToEarningsList",value:function(t,e){var n=this.element.querySelector(".earnings-list"),r=document.createElement("div");r.className="earnings-item";var a=this.cryptoService.getCryptoSymbol(e);r.innerHTML='\n      <span class="earn-amount">+'.concat(t.toFixed(4),'</span>\n      <span class="crypto-symbol">').concat(a,'</span>\n      <span class="earn-time">').concat((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"</span>\n    "),n.prepend(r),n.children.length>10&&n.removeChild(n.lastChild)}},{key:"updateBonusTimer",value:function(t){this.bonusStartTime||(this.bonusStartTime=Date.now(),this.bonusCooldown=3e5);var e=Date.now()-this.bonusStartTime,n=Math.max(0,this.bonusCooldown-e),r=Math.floor(n/6e4),a=Math.floor(n%6e4/1e3),i="".concat(r.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"));this.element.querySelector(".bonus-time").textContent=i;var o=100-n/this.bonusCooldown*100;this.element.querySelector(".bonus-progress").style.width="".concat(o,"%"),n<=0&&!this.isBonusActive&&this.enableBonus()}},{key:"enableBonus",value:function(){this.isBonusActive=!0,this.bonusMultiplier=2,this.bonusButton.disabled=!1,this.bonusButton.textContent="Получить 2x бонус на 30 сек!",this.bonusButton.classList.add("active"),this.bonusStartTime=null}},{key:"claimBonus",value:function(){var t=this;this.isBonusActive&&(this.isBonusActive=!1,this.bonusButton.disabled=!0,this.bonusButton.textContent="Бонус активен!",this.bonusButton.classList.remove("active"),this.userService.activateBonus(this.bonusMultiplier,3e4),setTimeout(function(){t.bonusButton.textContent="Бонус скоро будет доступен",t.bonusStartTime=Date.now()},3e4))}},{key:"updateUI",value:function(){this.element.querySelector(".balance-value").textContent=this.userService.getFormattedBalance(),this.element.querySelector(".crypto-ticker").innerHTML=this.renderCryptoTicker(),this.element.querySelector(".tap-power").textContent=this.userService.getTapPower(),this.element.querySelector(".passive-income").textContent="".concat(this.userService.getPassiveIncome(),"/сек")}},{key:"destroy",value:function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.autoTapperInterval&&clearInterval(this.autoTapperInterval)}},{key:"getElement",value:function(){return this.element}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}javascript;var c=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.element=this.createShopElement(),this.setupEventListeners()},(e=[{key:"createShopElement",value:function(){var t=document.createElement("div");t.className="shop-component";var e=this.getAvailableUpgrades(),n=this.userService.getBalance();return t.innerHTML='\n      <h2 class="shop-title">Магазин улучшений</h2>\n      <div class="balance-display">Ваш баланс: '.concat(n.toFixed(2),' USD</div>\n      \n      <div class="upgrade-categories">\n        <button class="category-btn active" data-category="all">Все</button>\n        <button class="category-btn" data-category="tap">Тапы</button>\n        <button class="category-btn" data-category="auto">Автоматика</button>\n        <button class="category-btn" data-category="boost">Бусты</button>\n      </div>\n      \n      <div class="upgrades-list">\n        ').concat(this.renderUpgradesList(e),"\n      </div>\n    "),t}},{key:"getAvailableUpgrades",value:function(){return[{id:"tap_power_1",name:"Усиленный тап I",description:"+1 к силе каждого тапа",price:100,category:"tap",owned:this.userService.hasUpgrade("tap_power_1"),icon:"💪"},{id:"tap_power_2",name:"Усиленный тап II",description:"+3 к силе каждого тапа",price:300,category:"tap",requires:"tap_power_1",owned:this.userService.hasUpgrade("tap_power_2"),icon:"💪💪"},{id:"auto_tap",name:"Авто-тапер",description:"Автоматически тапает 1 раз в секунду",price:500,category:"auto",owned:this.userService.hasUpgrade("auto_tap"),icon:"⏱️"},{id:"crypto_boost",name:"Крипто-буст",description:"+10% к заработку от всех источников",price:1e3,category:"boost",owned:this.userService.hasUpgrade("crypto_boost"),icon:"🚀"},{id:"luck_boost",name:"Удача",description:"Увеличивает шанс выпадения редкой крипты",price:800,category:"boost",owned:this.userService.hasUpgrade("luck_boost"),icon:"🍀"},{id:"multi_tap",name:"Мульти-тап",description:"25% шанс сделать двойной тап",price:1200,category:"tap",requires:"tap_power_2",owned:this.userService.hasUpgrade("multi_tap"),icon:"✖️"}]}},{key:"renderUpgradesList",value:function(t){var e=this;return 0===t.length?'<p class="no-upgrades">Нет доступных улучшений</p>':t.map(function(t){return'\n      <div class="upgrade-item '.concat(t.owned?"owned":""," ").concat(e.canBuyUpgrade(t)?"":"locked",'" \n           data-id="').concat(t.id,'">\n        <div class="upgrade-icon">').concat(t.icon,'</div>\n        <div class="upgrade-info">\n          <h3 class="upgrade-name">').concat(t.name,'</h3>\n          <p class="upgrade-description">').concat(t.description,"</p>\n          ").concat(t.requires?'<div class="upgrade-requires">Требуется: '.concat(e.getUpgradeName(t.requires),"</div>"):"",'\n        </div>\n        <div class="upgrade-price">\n          ').concat(t.owned?'<span class="owned-badge">Куплено</span>':"".concat(t.price.toFixed(2)," USD"),"\n        </div>\n      </div>\n    ")}).join("")}},{key:"canBuyUpgrade",value:function(t){return!t.owned&&!(t.requires&&!this.userService.hasUpgrade(t.requires))&&this.userService.getBalance()>=t.price}},{key:"getUpgradeName",value:function(t){var e=this.getAvailableUpgrades().find(function(e){return e.id===t});return e?e.name:t}},{key:"setupEventListeners",value:function(){var t=this;this.element.querySelectorAll(".category-btn").forEach(function(e){e.addEventListener("click",function(){t.element.querySelectorAll(".category-btn").forEach(function(t){return t.classList.remove("active")}),e.classList.add("active");var n=e.dataset.category,r=t.getAvailableUpgrades(),a="all"===n?r:r.filter(function(t){return t.category===n});t.element.querySelector(".upgrades-list").innerHTML=t.renderUpgradesList(a),t.setupUpgradeClickHandlers()})}),this.setupUpgradeClickHandlers()}},{key:"setupUpgradeClickHandlers",value:function(){var t=this;this.element.querySelectorAll(".upgrade-item:not(.owned)").forEach(function(e){e.addEventListener("click",function(){if(!e.classList.contains("locked")){var n=e.dataset.id,r=t.getAvailableUpgrades().find(function(t){return t.id===n});t.userService.getBalance()>=r.price?(t.userService.purchaseUpgrade(n,r.price),t.updateShopDisplay(),t.showPurchaseEffect(e)):t.showNotEnoughMoneyEffect()}})})}},{key:"updateShopDisplay",value:function(){var t=this.userService.getBalance();this.element.querySelector(".balance-display").textContent="Ваш баланс: ".concat(t.toFixed(2)," USD");var e=this.element.querySelector(".category-btn.active").dataset.category,n=this.getAvailableUpgrades(),r="all"===e?n:n.filter(function(t){return t.category===e});this.element.querySelector(".upgrades-list").innerHTML=this.renderUpgradesList(r),this.setupUpgradeClickHandlers()}},{key:"showPurchaseEffect",value:function(t){var e=document.createElement("div");e.className="purchase-effect",e.innerHTML="Успешно куплено!",t.appendChild(e),setTimeout(function(){e.classList.add("fade-out"),setTimeout(function(){return e.remove()},500)},1e3)}},{key:"showNotEnoughMoneyEffect",value:function(){var t=this.element.querySelector(".balance-display");t.classList.add("shake"),setTimeout(function(){t.classList.remove("shake")},500)}},{key:"getElement",value:function(){return this.element}}])&&o(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}javascript;var d=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.cryptoService=n,this.element=this.createWalletElement(),this.setupEventListeners(),this.updateInterval=this.setupAutoUpdate()},e=[{key:"createWalletElement",value:function(){var t=document.createElement("div");t.className="wallet-component";var e=this.userService.getCryptoBalances(),n=this.calculateTotalValue(e);return t.innerHTML='\n      <div class="wallet-header">\n        <h2 class="wallet-title">Мой крипто-кошелек</h2>\n        <div class="total-value">\n          <span class="total-label">Общая стоимость:</span>\n          <span class="total-amount">'.concat(n.toFixed(2),' USD</span>\n        </div>\n      </div>\n      \n      <div class="wallet-controls">\n        <div class="search-box">\n          <input type="text" class="search-input" placeholder="Поиск криптовалюты...">\n          <button class="search-button">🔍</button>\n        </div>\n        <div class="sort-options">\n          <select class="sort-select">\n            <option value="value">По стоимости</option>\n            <option value="name">По названию</option>\n            <option value="amount">По количеству</option>\n          </select>\n        </div>\n      </div>\n      \n      <div class="crypto-list">\n        ').concat(this.renderCryptoList(e),'\n      </div>\n      \n      <div class="wallet-actions">\n        <button class="action-button convert-button">Конвертировать</button>\n        <button class="action-button withdraw-button">Вывести</button>\n      </div>\n    '),t}},{key:"renderCryptoList",value:function(t){var e=this,n=Object.entries(t).filter(function(t){var e=l(t,2);return e[0],e[1]>0}).map(function(t){var n=l(t,2),r=n[0],a=n[1];return{symbol:r,name:e.cryptoService.getCryptoName(r),amount:a,value:e.cryptoService.getCryptoValue(r,a),change:e.cryptoService.getCryptoChange(r),icon:e.cryptoService.getCryptoIcon(r)}});return 0===n.length?'\n        <div class="empty-wallet">\n          <div class="empty-icon">💸</div>\n          <h3>Кошелек пуст</h3>\n          <p>Начните тапать, чтобы заработать криптовалюту!</p>\n        </div>\n      ':n.map(function(t){return'\n      <div class="crypto-item" data-symbol="'.concat(t.symbol,'">\n        <div class="crypto-icon">').concat(t.icon,'</div>\n        <div class="crypto-info">\n          <div class="crypto-name">').concat(t.name,'</div>\n          <div class="crypto-symbol">').concat(t.symbol,'</div>\n        </div>\n        <div class="crypto-amount">\n          <div class="amount">').concat(t.amount.toFixed(6),'</div>\n          <div class="value">').concat(t.value.toFixed(2),' USD</div>\n        </div>\n        <div class="crypto-change ').concat(t.change>=0?"positive":"negative",'">\n          ').concat(t.change>=0?"↑":"↓"," ").concat(Math.abs(t.change),"%\n        </div>\n      </div>\n    ")}).join("")}},{key:"calculateTotalValue",value:function(t){var e=this;return Object.entries(t).reduce(function(t,n){var r=l(n,2),a=r[0],i=r[1];return t+e.cryptoService.getCryptoValue(a,i)},0)}},{key:"setupEventListeners",value:function(){var t=this;this.element.querySelector(".search-input").addEventListener("input",function(e){t.filterCryptoList(e.target.value)}),this.element.querySelector(".sort-select").addEventListener("change",function(e){t.sortCryptoList(e.target.value)}),this.element.querySelector(".convert-button").addEventListener("click",function(){t.showConvertModal()}),this.element.querySelector(".withdraw-button").addEventListener("click",function(){t.showWithdrawModal()}),this.element.querySelectorAll(".crypto-item").forEach(function(e){e.addEventListener("click",function(){var n=e.dataset.symbol;t.showCryptoDetails(n)})})}},{key:"filterCryptoList",value:function(t){var e=this.element.querySelectorAll(".crypto-item"),n=t.toLowerCase();e.forEach(function(t){var e=t.querySelector(".crypto-name").textContent.toLowerCase(),r=t.querySelector(".crypto-symbol").textContent.toLowerCase(),a=e.includes(n)||r.includes(n);t.style.display=a?"flex":"none"})}},{key:"sortCryptoList",value:function(t){var e=this.element.querySelector(".crypto-list"),n=Array.from(this.element.querySelectorAll(".crypto-item"));n.sort(function(e,n){switch(e.dataset.symbol,n.dataset.symbol,t){case"name":return e.querySelector(".crypto-name").textContent.localeCompare(n.querySelector(".crypto-name").textContent);case"amount":var r=parseFloat(e.querySelector(".amount").textContent);return parseFloat(n.querySelector(".amount").textContent)-r;default:var a=parseFloat(e.querySelector(".value").textContent);return parseFloat(n.querySelector(".value").textContent)-a}}),e.innerHTML="",n.forEach(function(t){return e.appendChild(t)})}},{key:"showCryptoDetails",value:function(t){var e=this,n={symbol:t,name:this.cryptoService.getCryptoName(t),amount:this.userService.getCryptoBalance(t),value:this.cryptoService.getCryptoValue(t,this.userService.getCryptoBalance(t)),change:this.cryptoService.getCryptoChange(t),icon:this.cryptoService.getCryptoIcon(t)},r=document.createElement("div");r.className="modal crypto-details-modal",r.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>'.concat(n.icon," ").concat(n.name," (").concat(n.symbol,')</h3>\n          <button class="close-modal">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="crypto-stats">\n            <div class="stat">\n              <span class="stat-label">Количество:</span>\n              <span class="stat-value">').concat(n.amount.toFixed(6),'</span>\n            </div>\n            <div class="stat">\n              <span class="stat-label">Стоимость:</span>\n              <span class="stat-value">').concat(n.value.toFixed(2),' USD</span>\n            </div>\n            <div class="stat">\n              <span class="stat-label">Изменение (24ч):</span>\n              <span class="stat-value ').concat(n.change>=0?"positive":"negative",'">\n                ').concat(n.change>=0?"↑":"↓"," ").concat(Math.abs(n.change),'%\n              </span>\n            </div>\n          </div>\n          \n          <div class="crypto-chart">\n            <canvas id="crypto-chart"></canvas>\n          </div>\n          \n          <div class="crypto-actions">\n            <button class="action-button convert-single-button" data-symbol="').concat(n.symbol,'">\n              Конвертировать\n            </button>\n            <button class="action-button withdraw-single-button" data-symbol="').concat(n.symbol,'">\n              Вывести\n            </button>\n          </div>\n        </div>\n      </div>\n    '),document.body.appendChild(r),this.initChart(t,r.querySelector("#crypto-chart")),r.querySelector(".close-modal").addEventListener("click",function(){r.remove()}),r.querySelector(".convert-single-button").addEventListener("click",function(){r.remove(),e.showConvertModal(t)}),r.querySelector(".withdraw-single-button").addEventListener("click",function(){r.remove(),e.showWithdrawModal(t)})}},{key:"initChart",value:function(t,e){var n=this,r=e.getContext("2d"),a={labels:Array(24).fill(0).map(function(t,e){return"".concat(e,":00")}),datasets:[{label:"".concat(t," Price"),data:Array(24).fill(0).map(function(e,r){return n.cryptoService.getCryptoValue(t,1)*(.95+.1*Math.random())}),borderColor:"#6c5ce7",tension:.1,fill:!0,backgroundColor:"rgba(108, 92, 231, 0.1)"}]};new Chart(r,{type:"line",data:a,options:{responsive:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!1}}}})}},{key:"showConvertModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=document.createElement("div");n.className="modal convert-modal";var r=Object.keys(this.userService.getCryptoBalances()).filter(function(e){return t.userService.getCryptoBalance(e)>0});n.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>Конвертация криптовалюты</h3>\n          <button class="close-modal">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="convert-form">\n            <div class="convert-from">\n              <label>Отдаете:</label>\n              <div class="input-group">\n                <select class="crypto-select" '.concat(e?"disabled":"",">\n                  ").concat(e?'<option value="'.concat(e,'">').concat(e,"</option>"):r.map(function(e){return'\n                      <option value="'.concat(e,'">').concat(e," - ").concat(t.cryptoService.getCryptoName(e),"</option>\n                    ")}).join(""),'\n                </select>\n                <input type="number" class="amount-input" placeholder="0.00" step="0.000001">\n              </div>\n            </div>\n            \n            <div class="convert-arrow">⇅</div>\n            \n            <div class="convert-to">\n              <label>Получаете:</label>\n              <div class="input-group">\n                <select class="crypto-select">\n                  ').concat(r.map(function(e){return'\n                    <option value="'.concat(e,'">').concat(e," - ").concat(t.cryptoService.getCryptoName(e),"</option>\n                  ")}).join(""),'\n                </select>\n                <input type="number" class="amount-input" placeholder="0.00" readonly>\n              </div>\n            </div>\n          </div>\n          \n          <div class="convert-rate">\n            <span class="rate-label">Курс:</span>\n            <span class="rate-value">1 BTC = 15.5 ETH</span>\n          </div>\n          \n          <div class="convert-fee">\n            Комиссия конвертации: 1%\n          </div>\n          \n          <button class="action-button confirm-convert-button">Подтвердить конвертацию</button>\n        </div>\n      </div>\n    '),document.body.appendChild(n);var a=function(){var e=n.querySelector(".convert-from .crypto-select").value,r=n.querySelector(".convert-to .crypto-select").value,a=t.cryptoService.getCryptoValue(e,1)/t.cryptoService.getCryptoValue(r,1);n.querySelector(".rate-value").textContent="1 ".concat(e," = ").concat(a.toFixed(6)," ").concat(r);var i=(parseFloat(n.querySelector(".convert-from .amount-input").value)||0)*a*.99;n.querySelector(".convert-to .amount-input").value=i.toFixed(6)};n.querySelectorAll(".crypto-select").forEach(function(t){t.addEventListener("change",a)}),n.querySelector(".convert-from .amount-input").addEventListener("input",a),n.querySelector(".close-modal").addEventListener("click",function(){n.remove()}),n.querySelector(".confirm-convert-button").addEventListener("click",function(){var e=n.querySelector(".convert-from .crypto-select").value,r=n.querySelector(".convert-to .crypto-select").value,a=parseFloat(n.querySelector(".convert-from .amount-input").value);if(a<=0||isNaN(a))alert("Введите корректную сумму для конвертации");else if(a>t.userService.getCryptoBalance(e))alert("Недостаточно средств для конвертации");else{var i=a*(t.cryptoService.getCryptoValue(e,1)/t.cryptoService.getCryptoValue(r,1))*.99;t.userService.convertCrypto(e,r,a,i),t.updateWallet(),n.remove(),t.showNotification("Успешно конвертировано ".concat(a.toFixed(6)," ").concat(e," → ").concat(i.toFixed(6)," ").concat(r))}})}},{key:"showWithdrawModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=document.createElement("div");n.className="modal withdraw-modal";var r=Object.keys(this.userService.getCryptoBalances()).filter(function(e){return t.userService.getCryptoBalance(e)>0});n.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>Вывод криптовалюты</h3>\n          <button class="close-modal">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="withdraw-form">\n            <div class="form-group">\n              <label>Криптовалюта:</label>\n              <select class="crypto-select" '.concat(e?"disabled":"",">\n                ").concat(e?'<option value="'.concat(e,'">').concat(e,"</option>"):r.map(function(e){return'\n                    <option value="'.concat(e,'">').concat(e," - ").concat(t.cryptoService.getCryptoName(e),"</option>\n                  ")}).join(""),'\n              </select>\n            </div>\n            \n            <div class="form-group">\n              <label>Количество:</label>\n              <input type="number" class="amount-input" placeholder="0.00" step="0.000001">\n              <div class="balance-hint">\n                Доступно: <span class="available-balance">0.00</span>\n                <button class="max-button">MAX</button>\n              </div>\n            </div>\n            \n            <div class="form-group">\n              <label>Адрес кошелька:</label>\n              <input type="text" class="address-input" placeholder="Введите адрес кошелька">\n            </div>\n            \n            <div class="form-group">\n              <label>Сеть:</label>\n              <select class="network-select">\n                <option value="mainnet">Основная сеть (Mainnet)</option>\n                <option value="testnet">Тестовая сеть (Testnet)</option>\n                <option value="binance">Binance Smart Chain</option>\n                <option value="polygon">Polygon</option>\n              </select>\n            </div>\n            \n            <div class="withdraw-fee">\n              Комиссия вывода: <span class="fee-amount">0.0005</span>\n            </div>\n            \n            <div class="withdraw-summary">\n              Вы получите: <span class="received-amount">0.00</span>\n            </div>\n          </div>\n          \n          <button class="action-button confirm-withdraw-button">Подтвердить вывод</button>\n        </div>\n      </div>\n    '),document.body.appendChild(n);var a=function(){var e=n.querySelector(".crypto-select").value,r=t.userService.getCryptoBalance(e);n.querySelector(".available-balance").textContent=r.toFixed(6)},i=function(){var t=parseFloat(n.querySelector(".amount-input").value)||0,e=parseFloat(n.querySelector(".fee-amount").textContent),r=Math.max(0,t-e);n.querySelector(".received-amount").textContent=r.toFixed(6)};n.querySelector(".crypto-select").addEventListener("change",a),n.querySelector(".amount-input").addEventListener("input",i),n.querySelector(".max-button").addEventListener("click",function(){var e=n.querySelector(".crypto-select").value,r=t.userService.getCryptoBalance(e);n.querySelector(".amount-input").value=r.toFixed(6),i()}),n.querySelector(".close-modal").addEventListener("click",function(){n.remove()}),n.querySelector(".confirm-withdraw-button").addEventListener("click",function(){var e=n.querySelector(".crypto-select").value,r=parseFloat(n.querySelector(".amount-input").value),a=n.querySelector(".address-input").value.trim(),i=n.querySelector(".network-select").value,o=parseFloat(n.querySelector(".fee-amount").textContent);r<=0||isNaN(r)?alert("Введите корректную сумму для вывода"):r>t.userService.getCryptoBalance(e)?alert("Недостаточно средств для вывода"):a?(t.userService.withdrawCrypto(e,r,a,i,o),t.updateWallet(),n.remove(),t.showNotification("Запрос на вывод ".concat(r.toFixed(6)," ").concat(e," отправлен!"))):alert("Введите адрес кошелька")}),a(),i()}},{key:"showNotification",value:function(t){var e=document.createElement("div");e.className="notification",e.textContent=t,document.body.appendChild(e),setTimeout(function(){e.classList.add("fade-out"),setTimeout(function(){return e.remove()},500)},3e3)}},{key:"setupAutoUpdate",value:function(){var t=this;return setInterval(function(){t.updateWallet()},6e4)}},{key:"updateWallet",value:function(){var t=this,e=this.userService.getCryptoBalances(),n=this.calculateTotalValue(e);this.element.querySelector(".total-amount").textContent="".concat(n.toFixed(2)," USD"),this.element.querySelector(".crypto-list").innerHTML=this.renderCryptoList(e),this.element.querySelectorAll(".crypto-item").forEach(function(e){e.addEventListener("click",function(){var n=e.dataset.symbol;t.showCryptoDetails(n)})})}},{key:"destroy",value:function(){this.updateInterval&&clearInterval(this.updateInterval)}},{key:"getElement",value:function(){return this.element}}],e&&v(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}javascript;var b=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.element=this.createReferralElement(),this.setupEventListeners()},(e=[{key:"createReferralElement",value:function(){var t=document.createElement("div");t.className="referral-component";var e=this.userService.getReferralData(),n=this.generateReferralLink();return t.innerHTML='\n      <h2 class="referral-title">Реферальная система</h2>\n      <div class="referral-box">\n        <p class="referral-description">Приглашайте друзей и получайте бонусы!</p>\n        <div class="referral-link-container">\n          <input type="text" class="referral-link-input" value="'.concat(n,'" readonly>\n          <button class="copy-referral-button">Копировать</button>\n        </div>\n        <p class="referral-hint">За каждого приглашенного друга вы получите 10 USD и 5% от его заработка!</p>\n      </div>\n      \n      <div class="referral-stats">\n        <div class="stat-card">\n          <div class="stat-name">Приглашено</div>\n          <div class="stat-value">').concat(e.totalReferrals,'</div>\n        </div>\n        <div class="stat-card">\n          <div class="stat-name">Заработано</div>\n          <div class="stat-value">').concat(e.earned,' USD</div>\n        </div>\n        <div class="stat-card">\n          <div class="stat-name">Активные</div>\n          <div class="stat-value">').concat(e.activeReferrals,'</div>\n        </div>\n      </div>\n      \n      <h3 class="referral-list-title">Ваши рефералы</h3>\n      <div class="referral-list">\n        ').concat(this.renderReferralList(e.referrals),"\n      </div>\n    "),t}},{key:"renderReferralList",value:function(t){return 0===t.length?'<p class="no-referrals">У вас пока нет рефералов</p>':'\n      <table class="referral-table">\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>Дата</th>\n            <th>Заработано</th>\n            <th>Статус</th>\n          </tr>\n        </thead>\n        <tbody>\n          '.concat(t.map(function(t){return"\n            <tr>\n              <td>".concat(t.id.substring(0,8),"...</td>\n              <td>").concat(new Date(t.date).toLocaleDateString(),"</td>\n              <td>").concat(t.earned,' USD</td>\n              <td class="status-').concat(t.active?"active":"inactive",'">\n                ').concat(t.active?"Активен":"Неактивен","\n              </td>\n            </tr>\n          ")}).join(""),"\n        </tbody>\n      </table>\n    ")}},{key:"generateReferralLink",value:function(){var t=this.userService.getUserId();return"https://t.me/".concat(this.userService.getBotUsername(),"?start=ref_").concat(t)}},{key:"setupEventListeners",value:function(){var t=this;this.element.querySelector(".copy-referral-button").addEventListener("click",function(){t.element.querySelector(".referral-link-input").select(),document.execCommand("copy"),t.showCopyNotification()})}},{key:"showCopyNotification",value:function(){var t=document.createElement("div");t.className="copy-notification",t.textContent="Ссылка скопирована!",this.element.appendChild(t),setTimeout(function(){t.classList.add("fade-out"),setTimeout(function(){return t.remove()},500)},2e3)}},{key:"updateReferralStats",value:function(){var t=this.userService.getReferralData(),e=this.element.querySelectorAll(".stat-value");e.length>=3&&(e[0].textContent=t.totalReferrals,e[1].textContent="".concat(t.earned," USD"),e[2].textContent=t.activeReferrals);var n=this.element.querySelector(".referral-list");n&&(n.innerHTML=this.renderReferralList(t.referrals))}},{key:"getElement",value:function(){return this.element}}])&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,S(r.key),r)}}function S(t){var e=function(t){if("object"!=g(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:e+""}var k=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.achievementService=e,this.element=this.createAchievementsElement(),this.setupEventListeners(),this.achievementService.addListener(this.handleNewAchievements.bind(this))},(e=[{key:"createAchievementsElement",value:function(){var t=document.createElement("div");t.className="achievements-component";var e=this.achievementService.getAllAchievements(),n=e.filter(function(t){return t.unlocked}).length,r=e.length;return t.innerHTML='\n      <h2 class="achievements-title">Достижения</h2>\n      <div class="achievements-progress">\n        <div class="progress-bar">\n          <div class="progress-fill" style="width: '.concat(n/r*100,'%"></div>\n        </div>\n        <div class="progress-text">').concat(n," / ").concat(r,'</div>\n      </div>\n      \n      <div class="achievements-filter">\n        <button class="filter-btn active" data-filter="all">Все</button>\n        <button class="filter-btn" data-filter="unlocked">Разблокированные</button>\n        <button class="filter-btn" data-filter="locked">Заблокированные</button>\n      </div>\n      \n      <div class="achievements-list">\n        ').concat(this.renderAchievementsList(e),"\n      </div>\n    "),t}},{key:"renderAchievementsList",value:function(t){return 0===t.length?'<p class="no-achievements">Нет доступных достижений</p>':t.map(function(t){return'\n      <div class="achievement-item '.concat(t.unlocked?"unlocked":"locked",'" data-id="').concat(t.id,'">\n        <div class="achievement-icon">').concat(t.icon,'</div>\n        <div class="achievement-info">\n          <h3 class="achievement-name">').concat(t.name,'</h3>\n          <p class="achievement-description">').concat(t.description,'</p>\n        </div>\n        <div class="achievement-status">\n          ').concat(t.unlocked?'<span class="status-badge unlocked">Получено</span>':'<span class="status-badge locked">Не получено</span>',"\n        </div>\n      </div>\n    ")}).join("")}},{key:"setupEventListeners",value:function(){var t=this;this.element.querySelectorAll(".filter-btn").forEach(function(e){e.addEventListener("click",function(){t.element.querySelectorAll(".filter-btn").forEach(function(t){return t.classList.remove("active")}),e.classList.add("active");var n=e.dataset.filter,r=t.achievementService.getAllAchievements(),a=r;"unlocked"===n?a=r.filter(function(t){return t.unlocked}):"locked"===n&&(a=r.filter(function(t){return!t.unlocked})),t.element.querySelector(".achievements-list").innerHTML=t.renderAchievementsList(a)})})}},{key:"handleNewAchievements",value:function(t){var e=this;t.forEach(function(t){e.showAchievementNotification(t)}),this.updateAchievementsList()}},{key:"showAchievementNotification",value:function(t){var e=document.createElement("div");e.className="achievement-notification",e.innerHTML='\n      <div class="notification-icon">'.concat(t.icon,'</div>\n      <div class="notification-content">\n        <h3>Достижение разблокировано!</h3>\n        <p>').concat(t.name,'</p>\n        <p class="reward-text">Награда: ').concat(this.formatReward(t.reward),"</p>\n      </div>\n    "),document.body.appendChild(e),setTimeout(function(){e.classList.add("show"),setTimeout(function(){e.classList.add("hide"),setTimeout(function(){return e.remove()},500)},5e3)},100)}},{key:"formatReward",value:function(t){switch(t.type){case"crypto":return"".concat(t.value," ").concat(t.currency);case"tapPower":return"+".concat(t.value," к силе тапа");case"passiveIncome":return"+".concat(t.value," к пассивному доходу");case"bonus":return"Бонус: ".concat(t.name);default:return"Неизвестная награда"}}},{key:"updateAchievementsList",value:function(){var t=this.achievementService.getAllAchievements(),e=t.filter(function(t){return t.unlocked}).length,n=t.length;this.element.querySelector(".progress-fill").style.width="".concat(e/n*100,"%"),this.element.querySelector(".progress-text").textContent="".concat(e," / ").concat(n);var r=this.element.querySelector(".filter-btn.active").dataset.filter,a=t;"unlocked"===r?a=t.filter(function(t){return t.unlocked}):"locked"===r&&(a=t.filter(function(t){return!t.unlocked})),this.element.querySelector(".achievements-list").innerHTML=this.renderAchievementsList(a)}},{key:"getElement",value:function(){return this.element}}])&&w(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,T(r.key),r)}}function T(t){var e=function(t){if("object"!=E(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==E(e)?e:e+""}var x=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.cryptoService=n,this.element=this.createMinerElement(),this.setupEventListeners(),this.setupMiningInterval(),this.isMining=!1,this.miningPower=1,this.miningCrypto="BTC",this.miningDifficulty={BTC:100,ETH:50,SOL:20,BNB:30,XRP:10,ADA:15,DOGE:5,USDT:200},this.miningProgress=0},e=[{key:"createMinerElement",value:function(){var t=this,e=document.createElement("div");e.className="miner-component";var n=Object.keys(this.cryptoService.getAvailableCryptos(this.userService.getTotalBalance()));return e.innerHTML='\n      <h2 class="miner-title">Крипто-майнер</h2>\n      <div class="miner-description">\n        Запустите майнер, чтобы получать криптовалюту автоматически!\n      </div>\n      \n      <div class="miner-controls">\n        <div class="crypto-selector">\n          <label for="mining-crypto">Выберите криптовалюту:</label>\n          <select id="mining-crypto">\n            '.concat(n.map(function(e){return'\n              <option value="'.concat(e,'">').concat(t.cryptoService.getCryptoName(e)," (").concat(e,")</option>\n            ")}).join(""),'\n          </select>\n        </div>\n        \n        <div class="mining-stats">\n          <div class="stat">\n            <span class="stat-label">Мощность майнинга:</span>\n            <span class="stat-value mining-power">').concat(this.miningPower,'</span>\n          </div>\n          <div class="stat">\n            <span class="stat-label">Сложность:</span>\n            <span class="stat-value mining-difficulty">').concat(this.miningDifficulty[this.miningCrypto],'</span>\n          </div>\n        </div>\n        \n        <div class="mining-progress-container">\n          <div class="mining-progress">\n            <div class="progress-bar" style="width: 0%"></div>\n          </div>\n          <div class="progress-text">0%</div>\n        </div>\n        \n        <button class="mining-button">Начать майнинг</button>\n      </div>\n      \n      <div class="mining-upgrades">\n        <h3>Улучшения майнера</h3>\n        <div class="upgrades-list">\n          <div class="upgrade-item" data-upgrade="power">\n            <div class="upgrade-info">\n              <h4>Увеличить мощность</h4>\n              <p>+1 к мощности майнинга</p>\n            </div>\n            <button class="upgrade-button" data-cost="100">100 USD</button>\n          </div>\n          <div class="upgrade-item" data-upgrade="efficiency">\n            <div class="upgrade-info">\n              <h4>Повысить эффективность</h4>\n              <p>-10% к сложности майнинга</p>\n            </div>\n            <button class="upgrade-button" data-cost="200">200 USD</button>\n          </div>\n          <div class="upgrade-item" data-upgrade="multicoin">\n            <div class="upgrade-info">\n              <h4>Мульти-майнинг</h4>\n              <p>Шанс получить дополнительную монету</p>\n            </div>\n            <button class="upgrade-button" data-cost="500">500 USD</button>\n          </div>\n        </div>\n      </div>\n      \n      <div class="mining-history">\n        <h3>История майнинга</h3>\n        <div class="history-list"></div>\n      </div>\n    '),e}},{key:"setupEventListeners",value:function(){var t=this;this.miningButton=this.element.querySelector(".mining-button"),this.miningButton.addEventListener("click",function(){return t.toggleMining()}),this.cryptoSelect=this.element.querySelector("#mining-crypto"),this.cryptoSelect.addEventListener("change",function(){t.miningCrypto=t.cryptoSelect.value,t.updateMiningStats()}),this.element.querySelectorAll(".upgrade-button").forEach(function(e){e.addEventListener("click",function(){var n=e.parentElement.dataset.upgrade,r=parseInt(e.dataset.cost);t.userService.getTotalBalance()>=r?(t.purchaseUpgrade(n,r),e.dataset.cost=Math.floor(1.5*r),e.textContent="".concat(e.dataset.cost," USD")):t.showNotEnoughMoneyEffect(e)})})}},{key:"setupMiningInterval",value:function(){var t=this;this.miningInterval=setInterval(function(){t.isMining&&t.updateMiningProgress()},1e3)}},{key:"toggleMining",value:function(){this.isMining=!this.isMining,this.isMining?(this.miningButton.textContent="Остановить майнинг",this.miningButton.classList.add("active"),this.cryptoSelect.disabled=!0):(this.miningButton.textContent="Начать майнинг",this.miningButton.classList.remove("active"),this.cryptoSelect.disabled=!1)}},{key:"updateMiningProgress",value:function(){var t=this.miningDifficulty[this.miningCrypto],e=this.miningPower/t*100;this.miningProgress+=e;var n=this.element.querySelector(".progress-bar"),r=this.element.querySelector(".progress-text");n.style.width="".concat(Math.min(100,this.miningProgress),"%"),r.textContent="".concat(Math.min(100,Math.floor(this.miningProgress)),"%"),this.miningProgress>=100&&(this.mineCrypto(),this.miningProgress=0)}},{key:"mineCrypto",value:function(){var t=1/this.miningDifficulty[this.miningCrypto]*this.miningPower;if(t*=.9+.2*Math.random(),this.userService.addCrypto(this.miningCrypto,t),this.addToMiningHistory(this.miningCrypto,t),this.hasMulticoinUpgrade&&Math.random()<.2){var e=Object.keys(this.cryptoService.getAvailableCryptos(this.userService.getTotalBalance())),n=e[Math.floor(Math.random()*e.length)];if(n!==this.miningCrypto){var r=1/this.miningDifficulty[n]*(this.miningPower/2);this.userService.addCrypto(n,r),this.addToMiningHistory(n,r,!0)}}}},{key:"addToMiningHistory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.element.querySelector(".history-list"),a=document.createElement("div");a.className="history-item ".concat(n?"bonus":"");var i=this.cryptoService.getCryptoSymbol(t);a.innerHTML='\n      <span class="history-time">'.concat((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),'</span>\n      <span class="history-amount">+').concat(e.toFixed(8),'</span>\n      <span class="history-crypto">').concat(i," ").concat(t,"</span>\n      ").concat(n?'<span class="bonus-tag">БОНУС</span>':"","\n    "),r.prepend(a),r.children.length>10&&r.removeChild(r.lastChild)}},{key:"purchaseUpgrade",value:function(t,e){var n=this;switch(this.userService.spendBalance(e),t){case"power":this.miningPower+=1;break;case"efficiency":Object.keys(this.miningDifficulty).forEach(function(t){n.miningDifficulty[t]=Math.max(1,Math.floor(.9*n.miningDifficulty[t]))});break;case"multicoin":this.hasMulticoinUpgrade=!0}this.updateMiningStats(),this.showUpgradePurchasedEffect(t)}},{key:"updateMiningStats",value:function(){this.element.querySelector(".mining-power").textContent=this.miningPower,this.element.querySelector(".mining-difficulty").textContent=this.miningDifficulty[this.miningCrypto]}},{key:"showNotEnoughMoneyEffect",value:function(t){t.classList.add("shake"),setTimeout(function(){return t.classList.remove("shake")},500)}},{key:"showUpgradePurchasedEffect",value:function(t){var e=this.element.querySelector('[data-upgrade="'.concat(t,'"]')),n=document.createElement("div");n.className="purchase-effect",n.textContent="Улучшено!",e.appendChild(n),setTimeout(function(){n.classList.add("fade-out"),setTimeout(function(){return n.remove()},500)},1e3)}},{key:"destroy",value:function(){this.miningInterval&&clearInterval(this.miningInterval)}},{key:"getElement",value:function(){return this.element}}],e&&C(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function O(){O=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(e,n,r,a){var i=n&&n.prototype instanceof v?n:v,o=Object.create(i.prototype);return c(o,"_invoke",function(e,n,r){var a=1;return function(i,o){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=S(s,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var u=l(e,n,r);if("normal"===u.type){if(a=r.done?4:2,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=4,r.method="throw",r.arg=u.arg)}}}(e,r,new C(a||[])),!0),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function v(){}function h(){}function d(){}var f={};c(f,i,function(){return this});var y=Object.getPrototypeOf,m=y&&y(y(T([])));m&&m!==n&&r.call(m,i)&&(f=m);var b=d.prototype=v.prototype=Object.create(f);function g(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){function n(a,i,o,s){var c=l(t[a],t,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==A(p)&&r.call(p,"__await")?e.resolve(p.__await).then(function(t){n("next",t,o,s)},function(t){n("throw",t,o,s)}):e.resolve(p).then(function(t){u.value=t,o(u)},function(t){return n("throw",t,o,s)})}s(c.arg)}var a;c(this,"_invoke",function(t,r){function i(){return new e(function(e,a){n(t,r,e,a)})}return a=a?a.then(i,i):i()},!0)}function S(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=l(a,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var o=i.arg;return o?o.done?(n[e.r]=o.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function k(t){this.tryEntries.push(t)}function E(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function C(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function T(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(A(e)+" is not iterable")}return h.prototype=d,c(b,"constructor",d),c(d,"constructor",h),c(d,s,h.displayName="GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},g(w.prototype),c(w.prototype,o,function(){return this}),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},g(b),c(b,s,"Generator"),c(b,i,function(){return this}),c(b,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){o.type="throw",o.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===t||"continue"===t)&&a[0]<=e&&e<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var a=r.arg;E(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:T(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},e}function j(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function P(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(t){j(i,r,a,o,s,"next",t)}function s(t){j(i,r,a,o,s,"throw",t)}o(void 0)})}}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function B(t){var e=function(t){if("object"!=A(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==A(e)?e:e+""}const D=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiUrl="https://api.coincap.io/v2",this.cryptoMap={BTC:"bitcoin",ETH:"ethereum",SOL:"solana",BNB:"binance-coin",XRP:"xrp",ADA:"cardano",DOGE:"dogecoin",USDT:"tether"},this.lastRates={},this.lastUpdateTime=0,this.updateInterval=6e4},e=[{key:"getCurrentRates",value:(i=P(O().mark(function t(){var e,n,r,a,i,o,s=this,c=arguments;return O().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=c.length>0&&void 0!==c[0]?c[0]:Object.keys(this.cryptoMap),t.prev=1,!((n=Date.now())-this.lastUpdateTime<this.updateInterval&&Object.keys(this.lastRates).length>0)){t.next=5;break}return t.abrupt("return",this.lastRates);case 5:return r=e.map(function(t){return s.cryptoMap[t]}).filter(function(t){return t}),t.next=8,fetch("".concat(this.apiUrl,"/assets?ids=").concat(r.join(",")));case 8:if((a=t.sent).ok){t.next=11;break}throw new Error("API request failed: ".concat(a.status," ").concat(a.statusText));case 11:return t.next=13,a.json();case 13:return i=t.sent,o={},i.data.forEach(function(t){var e=Object.keys(s.cryptoMap).find(function(e){return s.cryptoMap[e]===t.id});e&&(o[e]=parseFloat(t.priceUsd))}),this.lastRates=o,this.lastUpdateTime=n,t.abrupt("return",o);case 21:return t.prev=21,t.t0=t.catch(1),console.error("Failed to get current rates:",t.t0),t.abrupt("return",{BTC:5e4,ETH:3e3,SOL:150,BNB:400,XRP:.5,ADA:.6,DOGE:.1,USDT:1});case 25:case"end":return t.stop()}},t,this,[[1,21]])})),function(){return i.apply(this,arguments)})},{key:"getPriceHistory",value:(a=P(O().mark(function t(e){var n,r,a,i,o,s,c,u=arguments;return O().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:"d1",r=u.length>2&&void 0!==u[2]?u[2]:null,a=u.length>3&&void 0!==u[3]?u[3]:null,t.prev=3,i=this.cryptoMap[e]){t.next=7;break}throw new Error("Unknown crypto symbol: ".concat(e));case 7:return o="".concat(this.apiUrl,"/assets/").concat(i,"/history?interval=").concat(n),r&&(o+="&start=".concat(r)),a&&(o+="&end=".concat(a)),t.next=12,fetch(o);case 12:if((s=t.sent).ok){t.next=15;break}throw new Error("API request failed: ".concat(s.status," ").concat(s.statusText));case 15:return t.next=17,s.json();case 17:return c=t.sent,t.abrupt("return",c.data.map(function(t){return[parseInt(t.time),parseFloat(t.priceUsd)]}));case 21:return t.prev=21,t.t0=t.catch(3),console.error("Failed to get price history:",t.t0),t.abrupt("return",[]);case 25:case"end":return t.stop()}},t,this,[[3,21]])})),function(t){return a.apply(this,arguments)})},{key:"getCryptoInfo",value:(r=P(O().mark(function t(e){var n,r,a;return O().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=this.cryptoMap[e]){t.next=4;break}throw new Error("Unknown crypto symbol: ".concat(e));case 4:return t.next=6,fetch("".concat(this.apiUrl,"/assets/").concat(n));case 6:if((r=t.sent).ok){t.next=9;break}throw new Error("API request failed: ".concat(r.status," ").concat(r.statusText));case 9:return t.next=11,r.json();case 11:return a=t.sent,t.abrupt("return",{id:a.data.id,symbol:a.data.symbol,name:a.data.name,price:parseFloat(a.data.priceUsd),marketCap:parseFloat(a.data.marketCapUsd),volume24h:parseFloat(a.data.volumeUsd24Hr),change24h:parseFloat(a.data.changePercent24Hr),supply:parseFloat(a.data.supply),maxSupply:parseFloat(a.data.maxSupply)});case 15:return t.prev=15,t.t0=t.catch(0),console.error("Failed to get crypto info:",t.t0),t.abrupt("return",null);case 19:case"end":return t.stop()}},t,this,[[0,15]])})),function(t){return r.apply(this,arguments)})},{key:"getTopCryptos",value:(n=P(O().mark(function t(){var e,n,r,a=arguments;return O().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:10,t.prev=1,t.next=4,fetch("".concat(this.apiUrl,"/assets?limit=").concat(e));case 4:if((n=t.sent).ok){t.next=7;break}throw new Error("API request failed: ".concat(n.status," ").concat(n.statusText));case 7:return t.next=9,n.json();case 9:return r=t.sent,t.abrupt("return",r.data.map(function(t){return{id:t.id,symbol:t.symbol,name:t.name,price:parseFloat(t.priceUsd),marketCap:parseFloat(t.marketCapUsd),change24h:parseFloat(t.changePercent24Hr)}}));case 13:return t.prev=13,t.t0=t.catch(1),console.error("Failed to get top cryptos:",t.t0),t.abrupt("return",[]);case 17:case"end":return t.stop()}},t,this,[[1,13]])})),function(){return n.apply(this,arguments)})}],e&&L(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,a,i}());function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(t,e)||M(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){if(t){if("string"==typeof t)return q(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _(){_=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(e,n,r,a){var i=n&&n.prototype instanceof v?n:v,o=Object.create(i.prototype);return c(o,"_invoke",function(e,n,r){var a=1;return function(i,o){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=S(s,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var u=l(e,n,r);if("normal"===u.type){if(a=r.done?4:2,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=4,r.method="throw",r.arg=u.arg)}}}(e,r,new C(a||[])),!0),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function v(){}function h(){}function d(){}var f={};c(f,i,function(){return this});var y=Object.getPrototypeOf,m=y&&y(y(T([])));m&&m!==n&&r.call(m,i)&&(f=m);var b=d.prototype=v.prototype=Object.create(f);function g(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){function n(a,i,o,s){var c=l(t[a],t,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==U(p)&&r.call(p,"__await")?e.resolve(p.__await).then(function(t){n("next",t,o,s)},function(t){n("throw",t,o,s)}):e.resolve(p).then(function(t){u.value=t,o(u)},function(t){return n("throw",t,o,s)})}s(c.arg)}var a;c(this,"_invoke",function(t,r){function i(){return new e(function(e,a){n(t,r,e,a)})}return a=a?a.then(i,i):i()},!0)}function S(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=l(a,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var o=i.arg;return o?o.done?(n[e.r]=o.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function k(t){this.tryEntries.push(t)}function E(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function C(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function T(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(U(e)+" is not iterable")}return h.prototype=d,c(b,"constructor",d),c(d,"constructor",h),c(d,s,h.displayName="GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},g(w.prototype),c(w.prototype,o,function(){return this}),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},g(b),c(b,s,"Generator"),c(b,i,function(){return this}),c(b,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){o.type="throw",o.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===t||"continue"===t)&&a[0]<=e&&e<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var a=r.arg;E(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:T(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},e}function F(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,H(r.key),r)}}function H(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}javascript;var R=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cryptos={BTC:{name:"Bitcoin",symbol:"₿",icon:"🟠",rate:5e4,volatility:.05,unlockAt:0},ETH:{name:"Ethereum",symbol:"Ξ",icon:"🔷",rate:3e3,volatility:.07,unlockAt:1e3},SOL:{name:"Solana",symbol:"◎",icon:"🌀",rate:150,volatility:.1,unlockAt:5e3},BNB:{name:"Binance Coin",symbol:"BNB",icon:"🟡",rate:400,volatility:.06,unlockAt:3e3},XRP:{name:"Ripple",symbol:"✕",icon:"✕",rate:.5,volatility:.08,unlockAt:2e3},ADA:{name:"Cardano",symbol:"₳",icon:"🔶",rate:.6,volatility:.09,unlockAt:2500},DOGE:{name:"Dogecoin",symbol:"Ð",icon:"🐶",rate:.1,volatility:.15,unlockAt:1e4},USDT:{name:"Tether",symbol:"₮",icon:"💵",rate:1,volatility:.01,unlockAt:500}},this.historicalData={},this.initializeHistoricalData(),this.lastUpdateTime=Date.now(),this.updateInterval=3e5,this.startPriceUpdates()},e=[{key:"initializeHistoricalData",value:function(){var t=this,e=Date.now();Object.keys(this.cryptos).forEach(function(n){t.historicalData[n]=[];for(var r=t.cryptos[n].rate,a=7;a>=0;a--){var i=e-864e5*a,o=t.cryptos[n].volatility,s=r*(1+(2*Math.random()-1)*o);t.historicalData[n].push({timestamp:i,rate:s})}})}},{key:"startPriceUpdates",value:function(){var t=this;this.updateIntervalId=setInterval(function(){t.updateCryptoRates()},this.updateInterval),this.updateCryptoRates(),this.fetchRealRates()}},{key:"updateCryptoRates",value:function(){var t=this,e=Date.now();Object.keys(this.cryptos).forEach(function(n){var r=t.cryptos[n].rate,a=t.cryptos[n].volatility,i=r*(1+(2*Math.random()-1)*a);t.cryptos[n].rate=i,t.historicalData[n].push({timestamp:e,rate:i}),t.historicalData[n].length>100&&t.historicalData[n].shift()}),this.lastUpdateTime=e}},{key:"fetchRealRates",value:(n=_().mark(function t(){var e,n,r=this;return _().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=Object.keys(this.cryptos),t.next=4,D.getCurrentRates(e);case 4:n=t.sent,Object.keys(n).forEach(function(t){r.cryptos[t]&&(r.cryptos[t].rate=n[t])}),console.log("Updated crypto rates from CoinCap API:",n),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Failed to fetch real crypto rates:",t.t0);case 12:case"end":return t.stop()}},t,this,[[0,9]])}),r=function(){var t=this,e=arguments;return new Promise(function(r,a){var i=n.apply(t,e);function o(t){F(i,r,a,o,s,"next",t)}function s(t){F(i,r,a,o,s,"throw",t)}o(void 0)})},function(){return r.apply(this,arguments)})},{key:"getAvailableCryptos",value:function(t){return Object.entries(this.cryptos).filter(function(e){var n=I(e,2);return n[0],n[1].unlockAt<=t}).reduce(function(t,e){var n=I(e,2),r=n[0],a=n[1];return t[r]=a,t},{})}},{key:"getRandomCrypto",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,n=Object.keys(this.getAvailableCryptos(e));if(0===n.length)return"BTC";for(var r=n.map(function(e){return 1/(10*t.cryptos[e].volatility)}),a=r.reduce(function(t,e){return t+e},0),i=Math.random()*a,o=0;o<n.length;o++){if(i<r[o])return n[o];i-=r[o]}return n[0]}},{key:"getCryptoName",value:function(t){var e;return(null===(e=this.cryptos[t])||void 0===e?void 0:e.name)||t}},{key:"getCryptoSymbol",value:function(t){var e;return(null===(e=this.cryptos[t])||void 0===e?void 0:e.symbol)||t}},{key:"getCryptoIcon",value:function(t){var e;return(null===(e=this.cryptos[t])||void 0===e?void 0:e.icon)||"🪙"}},{key:"getCryptoValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.cryptos[t]?this.cryptos[t].rate*e:0}},{key:"getCryptoChange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"24h";if(!this.historicalData[t]||this.historicalData[t].length<2)return 0;var n,r=Date.now();switch(e){case"1h":n=r-36e5;break;case"24h":default:n=r-864e5;break;case"7d":n=r-6048e5}var a,i=this.historicalData[t],o=i[0].rate,s=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=M(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){o=!0,a=t},f:function(){try{i||null==e.return||e.return()}finally{if(o)throw a}}}}(i);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.timestamp>=n)break;o=c.rate}}catch(t){s.e(t)}finally{s.f()}var u=this.cryptos[t].rate;return parseFloat(((u-o)/o*100).toFixed(2))}},{key:"getHistoricalRates",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"7d";if(!this.historicalData[t])return[];var n,r=Date.now();switch(e){case"1h":n=r-36e5;break;case"24h":n=r-864e5;break;case"7d":default:n=r-6048e5;break;case"30d":n=r-2592e6}return this.historicalData[t].filter(function(t){return t.timestamp>=n}).map(function(t){return{time:t.timestamp,value:t.rate}})}},{key:"calculateExchangeRate",value:function(t,e){var n,r,a=null===(n=this.cryptos[t])||void 0===n?void 0:n.rate,i=null===(r=this.cryptos[e])||void 0===r?void 0:r.rate;return a&&i?a/i:0}},{key:"getConversionFee",value:function(t,e,n){var r=.01;"USDT"!==t&&"USDT"!==e||(r=.02);var a=this.calculateExchangeRate(t,e),i=n*a,o=i*r;return{fee:o,received:i-o,rate:a,feePercent:100*r}}},{key:"getWithdrawalFee",value:function(t,e){var n={BTC:5e-4,ETH:.005,SOL:.01,BNB:.001,XRP:.25,ADA:1,DOGE:5,USDT:1}[t]||.01,r=this.getCryptoValue(t,n),a=.005*e,i=this.getCryptoValue(t,10),o=Math.min(Math.max(r,a),i);return{fee:o,received:e-o}}},{key:"destroy",value:function(){this.updateIntervalId&&clearInterval(this.updateIntervalId)}}],e&&N(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function V(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach(function(e){Y(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Y(t,e,n){return(e=K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $(){$=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(e,n,r,a){var i=n&&n.prototype instanceof v?n:v,o=Object.create(i.prototype);return c(o,"_invoke",function(e,n,r){var a=1;return function(i,o){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=S(s,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var u=l(e,n,r);if("normal"===u.type){if(a=r.done?4:2,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=4,r.method="throw",r.arg=u.arg)}}}(e,r,new C(a||[])),!0),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p={};function v(){}function h(){}function d(){}var f={};c(f,i,function(){return this});var y=Object.getPrototypeOf,m=y&&y(y(T([])));m&&m!==n&&r.call(m,i)&&(f=m);var b=d.prototype=v.prototype=Object.create(f);function g(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){function n(a,i,o,s){var c=l(t[a],t,i);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==G(p)&&r.call(p,"__await")?e.resolve(p.__await).then(function(t){n("next",t,o,s)},function(t){n("throw",t,o,s)}):e.resolve(p).then(function(t){u.value=t,o(u)},function(t){return n("throw",t,o,s)})}s(c.arg)}var a;c(this,"_invoke",function(t,r){function i(){return new e(function(e,a){n(t,r,e,a)})}return a=a?a.then(i,i):i()},!0)}function S(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=l(a,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var o=i.arg;return o?o.done?(n[e.r]=o.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function k(t){this.tryEntries.push(t)}function E(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function C(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function T(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(G(e)+" is not iterable")}return h.prototype=d,c(b,"constructor",d),c(d,"constructor",h),c(d,s,h.displayName="GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},g(w.prototype),c(w.prototype,o,function(){return this}),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},g(b),c(b,s,"Generator"),c(b,i,function(){return this}),c(b,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){o.type="throw",o.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===t||"continue"===t)&&a[0]<=e&&e<=a[2]&&(a=null);var i=a?a[4]:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a[2],p):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var a=r.arg;E(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:T(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},e}function J(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function Q(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(t){J(i,r,a,o,s,"next",t)}function s(t){J(i,r,a,o,s,"throw",t)}o(void 0)})}}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,K(r.key),r)}}function K(t){var e=function(t){if("object"!=G(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}const tt=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.userId=null,this.sessionId=this.generateSessionId(),this.events=[],this.maxQueueSize=20,this.init()},e=[{key:"init",value:(r=Q($().mark(function t(){return $().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{this.loadEvents(),this.initialized=!0,console.log("Local analytics initialized")}catch(t){console.error("Failed to initialize analytics:",t)}case 1:case"end":return t.stop()}},t,this)})),function(){return r.apply(this,arguments)})},{key:"generateSessionId",value:function(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}},{key:"setUserId",value:function(t){this.userId=t}},{key:"track",value:function(t){var e=X(X({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{timestamp:Date.now(),sessionId:this.sessionId});this.userId&&(e.userId=this.userId),this.queueEvent(t,e),this.events.length>=this.maxQueueSize&&this.flushEvents(),"true"===localStorage.getItem("DEBUG_MODE")&&console.log("Analytics event:",t,e)}},{key:"queueEvent",value:function(t,e){this.events.push({name:t,params:e}),this.saveEvents()}},{key:"saveEvents",value:function(){if("undefined"!=typeof localStorage)try{localStorage.setItem("analytics_events",JSON.stringify(this.events))}catch(t){console.error("Failed to save events to localStorage:",t)}}},{key:"loadEvents",value:function(){if("undefined"!=typeof localStorage)try{var t=localStorage.getItem("analytics_events");t&&(this.events=JSON.parse(t))}catch(t){console.error("Failed to load events from localStorage:",t)}}},{key:"flushEvents",value:(n=Q($().mark(function t(){return $().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.initialized&&0!==this.events.length){t.next=2;break}return t.abrupt("return");case 2:try{this.saveEvents(),"true"===localStorage.getItem("DEBUG_MODE")&&console.log("Analytics stats:",this.getStats())}catch(t){console.error("Failed to flush events:",t)}case 3:case"end":return t.stop()}},t,this)})),function(){return n.apply(this,arguments)})},{key:"trackScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.track("screen_view",X({screen_name:t},e))}},{key:"trackError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t instanceof Error?t.message:String(t),r=t instanceof Error?t.stack:null;this.track("error",X({error_message:n,error_stack:r},e))}},{key:"getStats",value:function(){var t={totalEvents:this.events.length,eventTypes:{},sessionCount:new Set(this.events.map(function(t){return t.params.sessionId})).size,firstEventTime:this.events.length>0?Math.min.apply(Math,V(this.events.map(function(t){return t.params.timestamp}))):null,lastEventTime:this.events.length>0?Math.max.apply(Math,V(this.events.map(function(t){return t.params.timestamp}))):null};return this.events.forEach(function(e){t.eventTypes[e.name]||(t.eventTypes[e.name]=0),t.eventTypes[e.name]++}),t}}],e&&Z(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}());function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach(function(e){it(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function it(t,e,n){return(e=st(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,st(r.key),r)}}function st(t){var e=function(t){if("object"!=et(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:e+""}var ct={balance:{BTC:0,ETH:0,SOL:0,BNB:0,XRP:0,ADA:0,DOGE:0,USDT:0},tapPower:1,passiveIncome:0,referralCode:function(){for(var t="",e=0;e<8;e++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(36*Math.random()));return t}(),referrals:[],subscription:"free",lastLogin:Date.now(),dailyStreak:0,unlockedAchievements:[],upgrades:[],bonuses:{},stats:{totalTaps:0,totalEarned:0,dailyTaps:0,referralsCount:0,earned:{BTC:0,ETH:0,SOL:0,BNB:0,XRP:0,ADA:0,DOGE:0,USDT:0}}};const ut=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.user=this.loadUser(),this.initializeUser()},e=[{key:"loadUser",value:function(){try{var t=localStorage.getItem("crypto_tapper_user");return t?JSON.parse(t):at({},ct)}catch(t){return console.error("Failed to load user",t),at({},ct)}}},{key:"initializeUser",value:function(){var t=this;this.user.passiveIncome||(this.user.passiveIncome=0),this.user.dailyStreak||(this.user.dailyStreak=0),this.user.unlockedAchievements||(this.user.unlockedAchievements=[]),this.user.upgrades||(this.user.upgrades=[]),this.user.bonuses||(this.user.bonuses={}),this.user.stats.totalEarned||(this.user.stats.totalEarned=0),this.user.stats.dailyTaps||(this.user.stats.dailyTaps=0),this.user.stats.referralsCount||(this.user.stats.referralsCount=0),["BTC","ETH","SOL","BNB","XRP","ADA","DOGE","USDT"].forEach(function(e){t.user.balance[e]||(t.user.balance[e]=0),t.user.stats.earned[e]||(t.user.stats.earned[e]=0)}),this.saveUser()}},{key:"saveUser",value:function(){return localStorage.setItem("crypto_tapper_user",JSON.stringify(this.user)),this.user}},{key:"addCrypto",value:function(t,e){return this.user.balance[t]||(this.user.balance[t]=0),this.user.balance[t]+=e,this.user.stats.earned[t]||(this.user.stats.earned[t]=0),this.user.stats.earned[t]+=e,this.user.stats.totalEarned+=e,tt.track("crypto_earned",{crypto:t,amount:e}),this.saveUser()}},{key:"spendCrypto",value:function(t,e){if(!this.user.balance[t]||this.user.balance[t]<e)throw new Error("Недостаточно средств");return this.user.balance[t]-=e,tt.track("crypto_spent",{crypto:t,amount:e}),this.saveUser()}},{key:"increaseTapPower",value:function(t){return this.user.tapPower+=t,tt.track("tap_power_increased",{value:t,newPower:this.user.tapPower}),this.saveUser()}},{key:"increasePassiveIncome",value:function(t){return this.user.passiveIncome+=t,tt.track("passive_income_increased",{value:t,newIncome:this.user.passiveIncome}),this.saveUser()}},{key:"purchaseUpgrade",value:function(t,e){if(this.getTotalBalance()<e)throw new Error("Недостаточно средств");return this.spendBalance(e),this.user.upgrades.includes(t)||this.user.upgrades.push(t),tt.track("upgrade_purchased",{upgradeId:t,cost:e}),this.saveUser()}},{key:"spendBalance",value:function(t){if(this.getTotalBalance()<t)throw new Error("Недостаточно средств");for(var e=t,n=0,r=Object.keys(this.user.balance);n<r.length;n++){var a=r[n];if(e<=0)break;if(!(this.getCryptoValue(a)<=0)){var i=Math.min(this.user.balance[a],e/this.getCryptoRate(a));this.user.balance[a]-=i,e-=i*this.getCryptoRate(a)}}return tt.track("balance_spent",{amount:t}),this.saveUser()}},{key:"activateBonus",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.user.bonuses[t]={value:e,expiresAt:n?Date.now()+n:null},tt.track("bonus_activated",{bonusName:t,value:e,duration:n}),this.saveUser()}},{key:"hasActiveBonus",value:function(t){var e=this.user.bonuses[t];return!(!e||e.expiresAt&&e.expiresAt<Date.now()&&(delete this.user.bonuses[t],this.saveUser(),1))}},{key:"getBonusValue",value:function(t){return this.hasActiveBonus(t)?this.user.bonuses[t].value:null}},{key:"unlockAchievement",value:function(t){return this.user.unlockedAchievements.includes(t)?this.user:(this.user.unlockedAchievements.push(t),tt.track("achievement_unlocked",{achievementId:t}),this.saveUser())}},{key:"handleReferral",value:function(t){if(!this.user.referrals.includes(t)){this.user.referrals.push(t),this.user.stats.referralsCount+=1;var e=function(t){switch(t){case"premium":return 5e-4;case"pro":return 3e-4;default:return 1e-4}}(this.user.subscription);return this.addCrypto("BTC",e),tt.track("referral_applied",{code:t,reward:e}),this.saveUser()}}},{key:"incrementTapCount",value:function(){return this.user.stats.totalTaps+=1,this.user.stats.dailyTaps+=1,this.saveUser()}},{key:"incrementDailyStreak",value:function(){return this.user.dailyStreak+=1,this.user.stats.dailyTaps=0,tt.track("daily_streak_increased",{streak:this.user.dailyStreak}),this.saveUser()}},{key:"resetDailyStreak",value:function(){return this.user.dailyStreak=1,this.user.stats.dailyTaps=0,tt.track("daily_streak_reset"),this.saveUser()}},{key:"updateLastLogin",value:function(){return this.user.lastLogin=Date.now(),this.saveUser()}},{key:"reset",value:function(){return this.user=at({},ct),this.saveUser()}},{key:"getCryptoBalance",value:function(t){return this.user.balance[t]||0}},{key:"getCryptoBalances",value:function(){return at({},this.user.balance)}},{key:"getCryptoRate",value:function(t){return{BTC:5e4,ETH:3e3,SOL:150,BNB:400,XRP:.5,ADA:.6,DOGE:.1,USDT:1}[t]||1}},{key:"getCryptoValue",value:function(t){return this.getCryptoBalance(t)*this.getCryptoRate(t)}},{key:"getTotalBalance",value:function(){var t=this;return Object.keys(this.user.balance).reduce(function(e,n){return e+t.getCryptoValue(n)},0)}},{key:"getFormattedBalance",value:function(){return"$".concat(this.getTotalBalance().toFixed(2))}},{key:"getTapPower",value:function(){var t=this.user.tapPower;return this.hasActiveBonus("tapPowerBoost")&&(t*=this.getBonusValue("tapPowerBoost")),t}},{key:"getPassiveIncome",value:function(){var t=this.user.passiveIncome;return this.hasActiveBonus("passiveIncomeBoost")&&(t*=this.getBonusValue("passiveIncomeBoost")),t}},{key:"hasUpgrade",value:function(t){return this.user.upgrades.includes(t)}},{key:"hasAutoTapper",value:function(){return this.hasUpgrade("auto_tap")}},{key:"hasPassiveIncome",value:function(){return this.user.passiveIncome>0}},{key:"hasMultiTap",value:function(){return this.hasUpgrade("multi_tap")||this.hasActiveBonus("multiTap")}},{key:"hasSubscription",value:function(){return"free"!==this.user.subscription}},{key:"getSubscriptionMultiplier",value:function(){switch(this.user.subscription){case"pro":return 1.5;case"premium":return 2;default:return 1}}},{key:"getReferralCode",value:function(){return this.user.referralCode}},{key:"getLastLogin",value:function(){return this.user.lastLogin}},{key:"getDailyStreak",value:function(){return this.user.dailyStreak}},{key:"getUnlockedAchievements",value:function(){return function(t){return function(t){if(Array.isArray(t))return nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return nt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.user.unlockedAchievements)}},{key:"getStats",value:function(){return at(at({},this.user.stats),{},{dailyStreak:this.user.dailyStreak})}}],e&&ot(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pt(Object(n),!0).forEach(function(e){ht(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ht(t,e,n){return(e=ft(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ft(r.key),r)}}function ft(t){var e=function(t){if("object"!=lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lt(e)?e:e+""}const yt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userService=e,this.achievements=this.defineAchievements(),this.listeners=[]},(e=[{key:"defineAchievements",value:function(){return[{id:"first_tap",name:"Первый тап",description:"Сделайте свой первый тап",icon:"🎯",condition:function(t){return t.totalTaps>=1},reward:{type:"tapPower",value:1}},{id:"tap_10",name:"Начинающий таппер",description:"Сделайте 10 тапов",icon:"👆",condition:function(t){return t.totalTaps>=10},reward:{type:"crypto",currency:"BTC",value:1e-4}},{id:"tap_100",name:"Опытный таппер",description:"Сделайте 100 тапов",icon:"👊",condition:function(t){return t.totalTaps>=100},reward:{type:"crypto",currency:"ETH",value:.001}},{id:"tap_1000",name:"Тап-мастер",description:"Сделайте 1000 тапов",icon:"💪",condition:function(t){return t.totalTaps>=1e3},reward:{type:"crypto",currency:"BTC",value:.001}},{id:"earn_btc",name:"Биткоин-энтузиаст",description:"Заработайте 0.01 BTC",icon:"₿",condition:function(t){return t.earned.BTC>=.01},reward:{type:"tapPower",value:2}},{id:"earn_eth",name:"Эфириум-фанат",description:"Заработайте 0.1 ETH",icon:"Ξ",condition:function(t){return t.earned.ETH>=.1},reward:{type:"tapPower",value:2}},{id:"earn_all",name:"Крипто-коллекционер",description:"Заработайте все виды криптовалют",icon:"🏆",condition:function(t){return["BTC","ETH","SOL","BNB","XRP","ADA","DOGE","USDT"].every(function(e){return t.earned[e]>0})},reward:{type:"bonus",name:"multiTap",value:!0}},{id:"daily_streak_3",name:"Постоянный игрок",description:"Играйте 3 дня подряд",icon:"📅",condition:function(t){return t.dailyStreak>=3},reward:{type:"crypto",currency:"DOGE",value:10}},{id:"daily_streak_7",name:"Недельный марафон",description:"Играйте 7 дней подряд",icon:"🗓️",condition:function(t){return t.dailyStreak>=7},reward:{type:"passiveIncome",value:1}},{id:"referral_1",name:"Приведи друга",description:"Пригласите 1 друга по реферальной ссылке",icon:"👥",condition:function(t){return t.referrals>=1},reward:{type:"crypto",currency:"BTC",value:5e-4}}]}},{key:"checkAchievements",value:function(){var t=this,e=this.userService.getStats(),n=this.userService.getUnlockedAchievements(),r=[];return this.achievements.forEach(function(a){n.includes(a.id)||a.condition(e)&&(t.userService.unlockAchievement(a.id),t.giveReward(a.reward),r.push(a))}),r.length>0&&this.notifyListeners(r),r}},{key:"giveReward",value:function(t){switch(t.type){case"crypto":this.userService.addCrypto(t.currency,t.value);break;case"tapPower":this.userService.increaseTapPower(t.value);break;case"passiveIncome":this.userService.increasePassiveIncome(t.value);break;case"bonus":this.userService.activateBonus(t.name,t.value)}}},{key:"getAchievement",value:function(t){return this.achievements.find(function(e){return e.id===t})}},{key:"getAllAchievements",value:function(){var t=this.userService.getUnlockedAchievements();return this.achievements.map(function(e){return vt(vt({},e),{},{unlocked:t.includes(e.id)})})}},{key:"addListener",value:function(t){this.listeners.push(t)}},{key:"removeListener",value:function(t){this.listeners=this.listeners.filter(function(e){return e!==t})}},{key:"notifyListeners",value:function(t){this.listeners.forEach(function(e){return e(t)})}}])&&dt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gt(r.key),r)}}function gt(t){var e=function(t){if("object"!=mt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mt(e)?e:e+""}var wt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initServices(),this.initComponents(),this.setupTelegramWebApp(),this.setupEventListeners(),this.renderApp(),this.checkDailyBonus()},e=[{key:"initServices",value:function(){this.cryptoService=new R,this.userService=ut,this.achievementService=new yt(this.userService)}},{key:"initComponents",value:function(){this.tapper=new a(this.userService,this.cryptoService),this.shop=new c(this.userService),this.wallet=new d(this.userService,this.cryptoService),this.referral=new b(this.userService),this.achievements=new k(this.achievementService),this.cryptoMiner=new x(this.userService,this.cryptoService),this.components={tapper:this.tapper,shop:this.shop,wallet:this.wallet,referral:this.referral,achievements:this.achievements,miner:this.cryptoMiner},this.activeComponent="tapper"}},{key:"setupTelegramWebApp",value:function(){if(window.Telegram&&window.Telegram.WebApp){window.Telegram.WebApp.expand(),window.Telegram.WebApp.ready();var t=window.Telegram.WebApp.initData;if(t){var e=t.match(/start=ref_(\w+)/);if(e){var n=e[1];this.userService.handleReferral(n)}}var r=window.Telegram.WebApp.colorScheme;document.body.classList.add(r)}}},{key:"setupEventListeners",value:function(){var t=this;document.addEventListener("click",function(e){if(e.target.closest(".nav-tab")){var n=e.target.closest(".nav-tab").dataset.tab;t.switchTab(n)}}),document.addEventListener("tap",function(){t.achievementService.checkAchievements()})}},{key:"renderApp",value:function(){var t=document.getElementById("app");t.innerHTML="";var e=document.createElement("div");e.className="navigation",e.innerHTML='\n      <div class="nav-tab '.concat("tapper"===this.activeComponent?"active":"",'" data-tab="tapper">\n        <span class="nav-icon">🎮</span>\n        <span class="nav-text">Тапер</span>\n      </div>\n      <div class="nav-tab ').concat("miner"===this.activeComponent?"active":"",'" data-tab="miner">\n        <span class="nav-icon">⛏️</span>\n        <span class="nav-text">Майнер</span>\n      </div>\n      <div class="nav-tab ').concat("shop"===this.activeComponent?"active":"",'" data-tab="shop">\n        <span class="nav-icon">🛒</span>\n        <span class="nav-text">Магазин</span>\n      </div>\n      <div class="nav-tab ').concat("wallet"===this.activeComponent?"active":"",'" data-tab="wallet">\n        <span class="nav-icon">💰</span>\n        <span class="nav-text">Кошелек</span>\n      </div>\n      <div class="nav-tab ').concat("achievements"===this.activeComponent?"active":"",'" data-tab="achievements">\n        <span class="nav-icon">🏆</span>\n        <span class="nav-text">Достижения</span>\n      </div>\n      <div class="nav-tab ').concat("referral"===this.activeComponent?"active":"",'" data-tab="referral">\n        <span class="nav-icon">👥</span>\n        <span class="nav-text">Рефералы</span>\n      </div>\n    ');var n=document.createElement("div");n.className="content",n.appendChild(this.components[this.activeComponent].getElement()),t.appendChild(n),t.appendChild(e)}},{key:"switchTab",value:function(t){this.activeComponent!==t&&(this.activeComponent=t,this.renderApp(),window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.HapticFeedback&&window.Telegram.WebApp.HapticFeedback.impactOccurred("light"))}},{key:"checkDailyBonus",value:function(){var t=this.userService.getLastLogin(),e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime(),r=new Date(t).getTime();if(r<n){var a=new Date(n);a.setDate(a.getDate()-1),r>=a.getTime()?this.userService.incrementDailyStreak():this.userService.resetDailyStreak(),this.showDailyBonus(),this.userService.updateLastLogin()}}},{key:"showDailyBonus",value:function(){var t=this.userService.getDailyStreak(),e=1e-4;t>=7?e=.001:t>=3&&(e=5e-4),this.userService.addCrypto("BTC",e);var n=document.createElement("div");n.className="modal daily-bonus-modal",n.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>Ежедневный бонус!</h3>\n          <button class="close-modal">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="bonus-icon">🎁</div>\n          <h4>День '.concat(t,"</h4>\n          <p>Вы получили <strong>").concat(e,' BTC</strong> за ежедневный вход!</p>\n          <div class="streak-info">\n            <p>Серия входов: ').concat(t," ").concat(1===t?"день":t<5?"дня":"дней",'</p>\n            <div class="streak-progress">\n              ').concat(Array(7).fill(0).map(function(e,n){return'\n                <div class="streak-day '.concat(n<t?"active":"",'"></div>\n              ')}).join(""),'\n            </div>\n            <p class="streak-hint">Приходите каждый день для увеличения бонуса!</p>\n          </div>\n          <button class="claim-bonus-btn">Забрать бонус</button>\n        </div>\n      </div>\n    '),document.body.appendChild(n),n.querySelector(".close-modal").addEventListener("click",function(){n.remove()}),n.querySelector(".claim-bonus-btn").addEventListener("click",function(){n.remove();var t=document.createElement("div");t.className="bonus-effect",t.innerHTML="+".concat(e," BTC"),document.body.appendChild(t),setTimeout(function(){t.classList.add("fade-out"),setTimeout(function(){return t.remove()},1e3)},2e3)})}}],e&&bt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();document.addEventListener("DOMContentLoaded",function(){new wt}),window.addEventListener("error",function(t){console.error("Global error:",t.error);var e=document.createElement("div");e.className="error-message",e.innerHTML='\n    <h3>Произошла ошибка</h3>\n    <p>Пожалуйста, перезагрузите приложение</p>\n    <button id="reload-app">Перезагрузить</button>\n  ',document.body.appendChild(e),document.getElementById("reload-app").addEventListener("click",function(){window.location.reload()})}),window.addEventListener("online",function(){document.body.classList.remove("offline")}),window.addEventListener("offline",function(){document.body.classList.add("offline");var t=document.createElement("div");t.className="offline-message",t.textContent="Нет подключения к интернету",document.body.appendChild(t),window.addEventListener("online",function(){t.remove()},{once:!0})})})();