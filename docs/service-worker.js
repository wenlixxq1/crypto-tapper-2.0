const CACHE_NAME="crypto-tapper-v1",ASSETS_TO_CACHE=["/","/index.html","/css/style.css","/css/achievements.css","/css/crypto-miner.css","/css/navigation.css","/css/animations.css","/js/app.js","/images/icon-192.png","/images/icon-512.png","https://telegram.org/js/telegram-web-app.js"];self.addEventListener("install",e=>{e.waitUntil(caches.open(CACHE_NAME).then(e=>(console.log("Caching app assets"),e.addAll(ASSETS_TO_CACHE))))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(e!==CACHE_NAME)return console.log("Deleting old cache:",e),caches.delete(e)}))))}),self.addEventListener("fetch",e=>{e.respondWith(caches.match(e.request).then(t=>t||fetch(e.request).then(t=>{if(!t||200!==t.status||"basic"!==t.type||"GET"!==e.request.method)return t;const s=t.clone();return caches.open(CACHE_NAME).then(t=>{t.put(e.request,s)}),t}).catch(t=>"navigate"===e.request.mode?caches.match("/offline.html"):new Response("Нет подключения к интернету",{status:503,statusText:"Service Unavailable",headers:new Headers({"Content-Type":"text/plain"})}))))}),self.addEventListener("push",e=>{const t=e.data.json(),s={body:t.body,icon:"/images/icon-192.png",badge:"/images/badge.png",vibrate:[100,50,100],data:{url:t.url}};e.waitUntil(self.registration.showNotification(t.title,s))}),self.addEventListener("notificationclick",e=>{e.notification.close(),e.notification.data&&e.notification.data.url&&e.waitUntil(clients.openWindow(e.notification.data.url))});